---
title: 'Implementando HMR en un proyecto de Angular'
date: 'üóìÔ∏èJulio 15, 2022'
tags: 'üîí Seguridad,üíªInformatica'
fecha: '2021-09-07'
descripcion: 'Con los ataques inform√°ticos, asegura tu web de ataques maliciosos con las mejores pr√°cticas'
---

# Angular HMR

Hola de nuevo.
En este art√≠culo, me gustaria mostrar c√≥mo implementar HMR-Hot Module en tu aplicacion de Angular.

Una de las cosas que m√°s puede molestarle a algunos cuando est√°n desarrollando su aplicaci√≥n de Angular es el reloading de la p√°gina cada vez que guardan los cambios, aunque sean m√≠nimos. Este reloading vuelve a cargar la pagina entera, pudiendo a veces, generar un problema en el rendimiento dependiendo de la m√°quina en la que estemos desarrollando.

Para evitar que el navegador recarge la pagina cada vez que guardamos cambios (Ctrl +S), debemos de hacer uso de la herramienta HMR.

## Qu√© es HMR

Hot Module Replacement(HMR) es una caracter√≠stica de Webpack. HMR actualiza tu aplicacion de angular sin que recompile y recargue toda tu proyecto.
Tambi√©n puedes visitar tu web para m√°s informaci√≥n.
Vamos a implementarlo en un nuevo proyecto de Angular.

Lo primero es a√±adir en nuestra carpeta de environments el siguiente archivo. *`src/environments/environment.hmr.ts`*

sh``export const environment = {

production: true,

hmr: false
};``

Despu√©s de a√±adir el anterior c√≥digo, necesitamos actualizar el entorno por defecto en *`src/environments/environment.ts`*.

``export const environment = {

production: false,

hmr: false

};``

Despu√©s de a√±adir los entornos, debemos de actualizar el archivo *angular.json*. Donde pone < project-name > debemos incluir el nombre de nuestro proyecto.
``
"build": {

"configurations": {

...

"hmr": {

"fileReplacements": [

{

"replace": "src/environments/environment.ts",

"with": "src/environments/environment.hmr.ts"

}

]

}

}

},

...

"serve": {

"configurations": {

...

"hmr": {

"hmr": true,

"browserTarget": "<project-name>:build:hmr"

}

}

}``

A√±adimos tambi√©n los tupos al archivo *`src/tsconfig.app.json`* como **node**.

``
{

...

"compilerOptions": {

...

"types": ["node"]

},

}
``

Despu√©s de a√±adir la configuracion debemos usar el siguiente comando para usar HMR.

**ng serve --configuration hmr**
SI queremos a√±adir un shortcut, podemos hacerlo en el *package.json* con el siguiente c√≥digo.
``
"scripts": {

...

"hmr": "ng serve --configuration hmr"

}
``

Desp√∫es de hacer todo lo anterior debemos instalar la siguiente dependecia.

``
npm install --save-dev @angularclass/hmr
``

Crea un archivo en *src/hmr.ts* con el siguiente contenido.

``
import { NgModuleRef, ApplicationRef } from '@angular/core';

import { createNewHosts } from '@angularclass/hmr';

export const hmrBootstrap = (module: any, bootstrap: () => Promise<NgModuleRef<any>>) => {

let ngModule: NgModuleRef<any>;

module.hot.accept();

bootstrap().then(mod => ngModule = mod);

module.hot.dispose(() => {

const appRef: ApplicationRef = ngModule.injector.get(ApplicationRef);

const elements = appRef.components.map(c => c.location.nativeElement);

const makeVisible = createNewHosts(elements);

ngModule.destroy();

makeVisible();

});

};
``

Despu√©s de a√±adir el anterior codigo, necesitamos actualizar el archivo *src/main.ts* con el siguiente contenido.

``
import { enableProdMode } from '@angular/core';

import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';

import { AppModule } from './app/app.module';

import { environment } from './environments/environment';

import { hmrBootstrap } from './hmr';

if (environment.production) {

enableProdMode();

}

const bootstrap = () => platformBrowserDynamic().bootstrapModule(AppModule);

if (environment.hmr) {

if (module[ 'hot' ]) {

hmrBootstrap(module, bootstrap);

} else {

console.error('HMR is not enabled for webpack-dev-server!');

console.log('Are you using the --hmr flag for ng serve?');

}

} else {

bootstrap().catch(err => console.log(err));

}
``

Finalemente, hemos terminado de implementar el HMR en nuestro proyecto de Angular.

``npm run hmr ``

Vamos a comparar nuestro proyecto con y sin HMR.

